CREATE SCHEMA `case_study_v1` DEFAULT CHARACTER SET utf8mb4 ;

//////////

CREATE TABLE `case_study_v1`.`users` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `fullName` VARCHAR(255) NOT NULL,
  `eMail` VARCHAR(255) NOT NULL,
  `address1` VARCHAR(50) NOT NULL,
  `address2` VARCHAR(50) NULL,
  `city` VARCHAR(165) NOT NULL,
  `state` VARCHAR(2) NULL,
  `country` VARCHAR(60) NULL,
  `zip` VARCHAR(15) NOT NULL,
  PRIMARY KEY (`id`));

//////////

CREATE TABLE `case_study_v1`.`users_role` (
  `id` INT(11) NOT NULL,
  `users_id` INT(11) NOT NULL,
  `users_role` VARCHAR(10) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `IDX_unique_users_role` (`users_id` ASC, `users_role` ASC) VISIBLE,
  CONSTRAINT `FK_user_id`
    FOREIGN KEY (`users_id`)
    REFERENCES `case_study_v1`.`users` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);

//////////

CREATE TABLE `case_study_v1`.`inventory` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(50) NOT NULL,
  `description` VARCHAR(254) NOT NULL,
  `stock_amount` INT NULL,
  `purchase_date` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `update_date` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `name_UNIQUE` (`name` ASC) VISIBLE);

//////////

CREATE TABLE `case_study_v1`.`shopping_cart` (
  `id` INT NOT NULL,
  `users_id` INT NOT NULL,
  `inventory_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `FK_users_id_idx` (`users_id` ASC) VISIBLE,
  INDEX `FK_inventory_id_idx` (`inventory_id` ASC) VISIBLE,
  CONSTRAINT `FK_users_id`
    FOREIGN KEY (`users_id`)
    REFERENCES `case_study_v1`.`users` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `FK_inventory_id`
    FOREIGN KEY (`inventory_id`)
    REFERENCES `case_study_v1`.`inventory` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);

//////////

    ALTER TABLE `case_study_v1`.`shopping_cart` 
ADD COLUMN `quantity` INT NOT NULL AFTER `inventory_id`;

//////////

ALTER TABLE `case_study_v1`.`users_role` 
CHANGE COLUMN `id` `id` INT(11) NOT NULL AUTO_INCREMENT ;

//////////

ALTER TABLE `case_study_v1`.`users` 
ADD COLUMN `phone` VARCHAR(20) NOT NULL AFTER `zip`;

/////////


